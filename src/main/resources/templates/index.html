<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>まもログ | Home</title>
	<link rel="stylesheet" href="/css/styles.css" />
</head>

<body>
	<div class="app-shell">
		<!-- ヘッダー -->
		<header class="topbar">
			<button id="menu-toggle" class="menu-btn">☰</button>
			<nav id="side-menu" class="side-menu">
				<ul>
					<li><a href="#" class="nav-link">ログイン</a></li>
					<li><a href="/todos/new" class="nav-link">Todo作成</a></li>
					<li><a href="/diary/new" class="nav-link">日記登録</a></li>
					<li><a href="#" class="nav-link">レポート参照</a></li>
					<li><a href="#" class="nav-link">設定</a></li>
				</ul>
			</nav>
			<div class="title">まもログ 🐥</div>
		</header>

		<!-- メイン -->
		<main class="main-area">
			<nav class="tabbar">
				<a class="tab active" href="/todos" data-tab="todo">タスク</a>
				<a class="tab" href="#" data-tab="diary">日記</a>
				<a class="tab" href="#" data-tab="calendar">カレンダー</a>
				<a class="tab" href="#" data-tab="mypage">マイページ</a>
			</nav>

			<!-- ツールコントロール -->
			<section class="controls">
				<input id="searchInput" type="search" placeholder="検索（タイトル）">
				<a href="/todos/new"><button class="btn">＋ 新規作成</button></a>
			</section>

			<!-- 未完了タスク（付箋風・縦並び） -->
			<section id="tab-content">
				<div id="todo" class="tab-pane active">
					<section class="todo-header">
						<h1>今日のやること</h1>
						<div class="remaining">
							残り：<span id="pending-count" th:text="${#lists.size(todoList)}">0</span> 件
						</div>
					</section>

					<!-- 未完了タスクリスト（縦並び） -->
					<section class="todo-list vertical" id="pending-list">
						<!-- 未完了は controller 側で findByCompleted(false) -> todoList -->
						<li th:each="todo : ${todoList}" class="todo-card" th:attr="data-id=${todo.id}">
							<div class="todo-main">
								<label class="chk">
									<input type="checkbox" class="todo-checkbox" th:attr="data-id=${todo.id}" />
									<span class="fakebox"></span>
								</label>

								<div class="todo-body">
									<div class="todo-title" th:text="${todo.title}">タイトル</div>
									<div class="todo-meta" th:text="${todo.memo}">メモ</div>
									<!-- 期限表示（存在する場合のみ） -->
									<div class="todo-meta" th:if="${todo.dueDate != null}">
										期限:
										<span th:text="${todo.dueDate}">yyyy-MM-dd</span>
										<span th:if="${todo.dueTime != null}" th:text="${todo.dueTime}">HH:mm</span>
									</div>
								</div>
							</div>

							<!-- 編集リンク（未完了にのみ表示） -->
							<div class="todo-actions">
								<a th:href="@{/todos/{id}/edit(id=${todo.id})}" class="edit-link">編集</a>
							</div>
						</li>
					</section>

					<!-- 完了タスク（初期表示：表示） -->
					<section class="completed-tasks">
						<h2>
							完了タスク
							<button id="toggle-completed-btn" type="button">非表示にする</button>
						</h2>

						<!-- 完了は controller 側で findByCompleted(true) -> completedList -->
						<section class="todo-list vertical" id="completed-list">
							<li th:each="todo : ${completedList}" class="todo-card done" th:attr="data-id=${todo.id}">
								<div class="todo-main">
									<label class="chk">
										<input type="checkbox" class="todo-checkbox" th:attr="data-id=${todo.id}"
											checked />
										<span class="fakebox"></span>
									</label>

									<div class="todo-body">
										<div class="todo-title" th:text="${todo.title}">タイトル</div>
										<div class="todo-meta" th:text="${todo.memo}">メモ</div>
										<div class="todo-meta" th:if="${todo.dueDate != null}">
											期限:
											<span th:text="${todo.dueDate}">yyyy-MM-dd</span>
											<span th:if="${todo.dueTime != null}" th:text="${todo.dueTime}">HH:mm</span>
										</div>
									</div>
								</div>
								<!-- 完了の行には編集リンクは表示しない（要望に応じて可） -->
							</li>
						</section>
					</section>

				</div>
			</section>
		</main>
	</div>

	<script src="/js/app.js"></script>
	<script src="/js/todo-new.js"></script>
</body>

</html>